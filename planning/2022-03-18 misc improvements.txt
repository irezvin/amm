2022-03-18 Антивоенная терапия

Вопросы по Amm в ходе просмотра того, на чем я остановился

>   Таблица с twin view:
    +   пофиксить dragDrop
        +   сейчас двигается "ghost" только у первого view (даже если начали
            во втором)
        +   некорректно устанавливается положение при завершении перетягивания
            (пока перетягиваем, подсветка корректная) - всегда срабатывает
            "опускание с внутренней стороны", даже если подсвечивается 
            "с внешней" (это относится и к строкам, и к столбцам)
            
    +   сделать, чтобы редактор выводился в "активном" view
    
        X   понятие "активного" view?!
        
        i   сделал два уродливых хака -- 01.06.2022
        -   чтобы "уродливости" не было, нужно 
        
            + а делать другой display parent view у ячейки (например,
                Amm.View.Html.CellItems extends Amm.View.Html.DisplayParent)
                
            - б уходить от практики constructDefaultViews по умолчанию
                и создавать некоторый объект, например Amm.Template,
                привязанный к элементу, который будет реагировать на
                constructDefaultViews(element); если template у элемента
                отсутствует, то используется template его компонента.
                
            Template таблицы (Amm.View.Html.Table.Template) знает, какую 
            разметку создавать для ячеек, столбцов, строк и т.п.

    +   доделать shouldShowItemCallback у collection view,
        возможность выводить в таблице-дубле только определенные секции
        (header, footer) // переписал collectionView 21.03
        
        +   поправить баг: при клике на ячейку вываливается исключение,
            и не получается разместить редактор в ячейке?!
        
    -   если у ячеек несколько views, возможность подстраивать их ширину-высоту
        под максимальную (тут много вопросов)
        
>   !!! Drag-and-drop + pointer events (touch screen)

    +   13-drag.php
    +   всё, что связано с таблицей
    +   проверить, может, css будет достаточно
    -   возможность начать движение не после достаточного перемещения,
        а после hold заданной длинны (например, 1 сек). 
    -   в touch screen делать подсказку, выходящую за границы пальца?! 
        чтобы было видно?
    -   таблица
        -   resize + touch не работает, потому что drag handle выводится 
            при hover. Надо выводить отдельно расположенный handle 
            при активации ячейки-заголовка

-   Paginator: теряет фокус из-за перестройки dom. Варианты:
    -   использовать virtual dom при обновлени
    -   более интеллектуальная замена ссылок
    -   забить
    >   запоминать фокус и восстанавливать его - это выглядит лучше всего?
        (replaceDomPreserveFocus)
        
2022-06-08
==========

-   Я сделал шнягу с "parentView", но сейчас это работает 
    только с displayParent'ами, которые создают views потомков
-   Хотелось бы, чтобы builder тоже корректно отрабатывал иерархию, но для
    этого мы должны создавать views сверху вниз, а не снизу вверх, как сейчас!

2022-08-12
==========

-   Как подфиксить прокрутку fixed-таблицы при табуляции:

    .mainTable .data td, .mainTable .data th {
        scroll-margin-top: 31px; /* высота фиксированного заголовка */
        scroll-margin-left: 26px; /* высота фиксированной левой колонки */
    } 
    
    это "правило" нужно динамически менять при изменении размеров
    фиксированных областей.
    
    при движении по фиксированным ячейкам прокрутка всё равно не срабатывает;
    надо проверять, чтобы активная ячейка оказывалась в viewport'е
    .scrollableTableInner
    (смотреть её и viewport'а getBoundingClientRect(); если вне viewport'а,
    то вызывать jQuery('.mainTable *.active').scrollIntoView()
    
    при фокусировке "фиксированных" ячеек в .mainTable нужно передавать focus
    фиксированным ячейкам слева/вверху/в углу (свойство focusPriority?)
    
-   Нужно сделать, чтобы constructDefaultViews() с возвратом DOM'а было
    у view, а не у элемента, потому что жестко нарушается разделение уровней;
    но при этом возникает вопрос курицы-яйца: мы создаем Amm.View.Html.Table,
    который создает свою структуру с параметрами (в конструкторе?), в том числе
    еще несколько views/clones.
    
-   Вопрос по автоматическому связыванию views контейнеров/содержимого 
    без staticDisplayParent ??? сейчас всё строится "снизу вверх", как быть?
    
    